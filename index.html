<!doctype html>
<html lang='en-GB'>
<head>
  <meta charset='utf-8'>
  <title>Mad Libs</title>
  <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
  <style>
    span.blank {
      color: red;
      font-size: 1.2em;
    }
    #container {
      width: 80%;
      margin: 0 auto;
    }

    #title {
      text-align: center;
    }

    li {
      list-style: none;
      margin: 20px 0;
    }
  </style>
</head>

<body>
  <h2 id='title'>Gettysburg Address Mad Libs</h2>
  <!--
       1. This is the element we'll render our Ractive to.
  -->
  <div id='container'>
  </div>

  <!--
       2. You can load a template in many ways. For convenience, we'll include it in
       a script tag so that we don't need to mess around with AJAX or multiline strings.
       Note that we've set the type attribute to 'text/ractive' - though it can be
       just about anything except 'text/javascript'
  -->
  <script id='template' type='text/ractive'>
    <div class='row'>
      <div class="col-md-6">
        <h2>Pick a part of speech</h2>
        <li><input placeholder='Choose a number' value='{{seven.placeholder}}'></li>
        <li><input placeholder='Choose a noun' value='{{nation.placeholder}}'></li>
        <li><input placeholder='Choose an adjective' value='{{equal.placeholder}}'></li>
        <li><input placeholder='Choose a plural noun' value='{{people.placeholder}}'></li>
        <button on-click='solution' class="btn btn-primary">Make a guess</button>
        <h3>{{percentageCorrect(numberCorrect, totalGuesses)}}% correct</h3>
        <h4>Attempts: {{totalTries}}</h4>
      </div>
      <div class="col-md-6">
        <h2>Gettysburg Address</h2>
        <p>
          Fourscore and <span class='blank seven'>{{seven.placeholder}}</span> years ago our fathers brought
          forth on this continent a new <span class='blank nation'>{{nation.placeholder}}</span>,
          conceived in liberty and dedicated to the proposition that all men
          are created <span class='blank equal'>{{equal.placeholder}}.</span> Now we are engaged
          in a great civil war, testing whether that <span class='blank nation'>{{nation.placeholder}}
          </span> or any <span class='blank nation'>{{nation.placeholder}}</span> so conceived and
          so dedicated can long endure. We are met on a great battlefield of that war.
          We have come to dedicate a portion of that field as a final resting-place
          for those who here gave their lives that that <span class='blank nation'>
          {{nation.placeholder}}</span> might live. It is altogether fitting and proper that
          we should do this. But in a larger sense, we cannot dedicate, we cannot
          consecrate, we cannot hallow this ground. The brave men, living and
          dead who struggled here have consecrated it far above our poor power
          to add or detract. The world will little note nor long remember what
          we say here, but it can never forget what they did here. It is for us
          the living rather to be dedicated here to the unfinished work which
          they who fought here have thus far so nobly advanced. It is rather for
          us to be here dedicated to the great task remaining before us--that from
          these honored dead we take increased devotion to that cause for which
          they gave the last full measure of devotion--that we here highly resolve
          that these dead shall not have died in vain, that this
          <span class='blank nation'>{{nation.placeholder}}</span> under God shall have a new birth
          of freedom, and that government of the <span class='blank people'>{{people.placeholder}},</span>
          by the <span class='blank people'>{{people.placeholder}},</span> for the <span class='blank people'>
          {{people.placeholder}}</span> shall not perish from the earth.
        </p>
      </div>
    </div>

  </script>

  <!--
       3. You can always get the most recent stable version from the URL below.
       If you want the newest features, use the 'edge' version instead:

           http://cdn.ractivejs.org/edge/ractive.min.js

       If you need IE8 support, change 'ractive' to 'ractive-legacy'.
  -->
  <script src='http://cdn.ractivejs.org/latest/ractive.min.js'></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!--
       4. We've got an element in the DOM, we've created a template, and we've
       loaded the library - now it's time to build our Hello World app.
  -->
  <script>
    var ractive = new Ractive({
      // The `el` option can be a node, an ID, or a CSS selector.
      el: 'container',

      // We could pass in a string, but for the sake of convenience
      // we're passing the ID of the <script> tag above.
      template: '#template',

      // Here, we're passing in some initial data
      data: {
              seven: { placeholder: 'NUMBER (1)', correct: false },
              nation: { placeholder: 'NOUN (5)', correct: false },
              equal: { placeholder: 'ADJ (1)', correct: false },
              people: { placeholder: 'PLURAL NOUN (4)', correct: false },
              numberCorrect: 0,
              totalGuesses: 4,
              totalTries: 0,
              percentageCorrect: function(correct, guesses) {
                  if (guesses > 0) {
                  return correct / guesses * 100;
                } else {
                  return '-';
                }
              }
            }
    });
    ractive.on('solution', function(event){
      ractive.set( 'totalTries', ractive.get( 'totalTries' ) + 1 );
      checkCorrect('seven');
      checkCorrect('nation');
      checkCorrect('equal');
      checkCorrect('people');
    });

    function checkCorrect(string) {
       if (isCorrect(string)) {
        $('.' + string).css('color', 'green');
        ractive.set( 'numberCorrect', ractive.get( 'numberCorrect' ) + 1 );
        ractive.set(string, { correct: true, placeholder: string })
      }
    }

    function isCorrect(string) {
      if (ractive.data[string].placeholder === string && ractive.data[string].correct === false) {
        return true;
      } else {
        return false;
      }
    }
  </script>
</body>
